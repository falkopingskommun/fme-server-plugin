var FME;(()=>{"use strict";var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>a});const n=Origo;var o=t.n(n);const a=function(t={}){const{title:e="Hämta data"}=t;let n,a,i,d,r,l,u,c,s,m;return o().ui.Component({name:"fme",onInit(){n=o().ui.Button({cls:"o-fme padding-small icon-smaller round light box-shadow",click(){c=a.getLayers(),m=function(){let t="";return c.forEach((e=>{!0===e.getVisible()&&e.get("fme")&&(t+=`<li>${e.get("title")}</li>`)})),t}(),r=m?`<br>Nedan listas de lager som du kommer att hämta från den aktuella vyn:<br><br><div id="fme-list">${m}</div><br>\n                      <select id="input-DestinationFormat"><option>Välj format</option></select>\n                      <input id="o-fme-download-button" type="button" value="Spara" disabled></input>`:'<p style="font-style:italic;">Du måste tända ett nedladdningsbart lager i kartan för att kunna hämta data.</p>',d=o().ui.Modal({title:e,content:r,target:a.getId()}),this.addComponent(d),m&&(function(){const e=document.getElementById("input-DestinationFormat");for(let n=0;n<t.destinationFormat.length;n+=1){const o=t.destinationFormat[n],a=document.createElement("option");a.textContent=o,a.value=o,e.appendChild(a)}}(),document.querySelector("#input-DestinationFormat").addEventListener("change",(()=>{0!==document.querySelector("#input-DestinationFormat").selectedIndex?document.querySelector("#o-fme-download-button").removeAttribute("disabled"):document.querySelector("#o-fme-download-button").disabled=!0})),document.querySelector("#o-fme-download-button").addEventListener("click",(()=>{(function(){u=document.getElementById("input-DestinationFormat"),u=`&DestinationFormat=${u.options[u.selectedIndex].text}`,s=`&layer=${function(){let t="";return c.forEach((e=>{!0===e.getVisible()&&e.get("fme")&&(t+=`${e.get("name")};`)})),t=t.split(";").join("%20"),t}()}`,l=`&extent=${function(){const t=a.getMap(),e=t.getSize();return l=t.getView().calculateExtent(e),l.forEach(((t,e)=>{l[e]=Math.round(1*t)/1})),l=encodeURI(l).replace(/,/g,"%20"),l}()}`;let e=t.url+u+s+l;t.username&&(e+=`&username=${localStorage.getItem("username")}`),window.open(e,"_self")})(),d.closeModal()})))},icon:"#fa-download",tooltipText:e,tooltipPlacement:"east"})},onAdd(t){a=t.target,i||(i=`${a.getMain().getNavigation().getId()}`),this.addComponents([n]),this.render()},render(){const t=n.render(),e=o().ui.dom.html(t);document.getElementById(i).appendChild(e),this.dispatch("render")}})};FME=e.default})();